# 4. DICTIONARIES AND RULES

## 4.1. General Information

### 4.1.1 Purpose _(High Priority)_

To establish a structure for dictionaries and a set of rules for generating realistic fake data for anonymization purposes, covering:

- Critical identifying data (Priority 1)
- Sensitive data (Priority 2)
- Indirect identifying data (Priority 3)

### 4.1.2 Supported Languages and Regions _(Prioritization)_

|Language|Regions|Region Code|Priority|
|---|---|---|---|
|Russian|Russia|RU|High - first iteration|
|English|United States|US|Medium - second iteration|
|English|Canada|CA|Medium - second iteration|
|Vietnamese|Vietnam|VN|Medium - second iteration|
|English|United Kingdom|GB|Low - future versions|
|English|Australia|AU|Low - future versions|
|German|Germany|DE|Low - future versions|
|French|France|FR|Low - future versions|
|Spanish|Spain|ES|Low - future versions|

### 4.1.3 Data Type Priorities

- **Priority 1**: Critical identifiers (names, email, phones, logins, passport data) _(High Priority)_
- **Priority 2**: Sensitive data (patronymics, medical diagnoses, birth dates) _(Medium Priority)_
- **Priority 3**: Indirect identifiers (addresses, regions, educational institutions) _(Low Priority)_

### 4.1.4 Expanding Language and Region Support _(Low Priority for MVP)_

Requirements for adding a new language/region:

1. Create dictionaries for all Priority 1 data types
2. Implement language-specific generation rules
3. Add validators for region-specific formats
4. Update configuration in package system settings
5. Add tests for new dictionaries and generation rules

## 4.2. Dictionary Format _(High Priority)_

### 4.2.1 Basic Format

Dictionary format requirements:

- CSV or JSON
- UTF-8 encoding (UTF-16)
- Mandatory fields: id, value
- Optional fields: gender, region, weight, version, additional_params

### 4.2.2 Field Explanations

- **id**: Unique record identifier (integer or string)
- **value**: Primary value (first name, last name, domain, etc.)
- **gender**: Gender (М/M - male, Ж/F - female, null - undefined or applicable to both)
- **region**: Region/country (two-letter country code, for regions within country: RU-MOS, US-NY)
- **weight**: Frequency/weight of value (0-1)
- **version**: Dictionary record version (X.Y format)
- **additional_params**: Additional parameters as JSON (e.g., spelling variations)

### 4.2.3 Encoding and Delimiters

- Encoding: UTF-8.  UTF-16
- CSV delimiter: comma (, or ;)
- CSV escaping: double quotes (")
- First CSV row must contain column headers

### 4.2.4 Dictionary Versioning _(Medium Priority)_

Dictionary metadata requirements:

- Version format: X.Y.Z (SemVer)
- X - major version (structure change)
- Y - minor version (addition of new records)
- Z - patch version (error corrections, weight updates)

## 4.3. Supported Dictionary Types

### 4.3.1 First and Last Names (Priority 1) _(High Priority)_

**Structure requirements:**

- **first_names.csv/json**: First names with fields: id, value, gender, region, weight
- **last_names.csv/json**: Last names with fields: id, value, gender (optional), region, weight

**File naming rules:**

- `first_names_ru.csv` - first names for Russia
- `first_names_us.csv` - first names for USA
- `last_names_ca.csv` - last names for Canada

**Validation requirements:**

- For Russian last names: specify female form through additional_params
- For English names: specify common abbreviations
- All names must start with a capital letter
- Numbers and special characters are not allowed (except hyphen and apostrophe)

### 4.3.2 Patronymics (Priority 2, for Russian language) _(High Priority)_

**Structure requirements:**

- **middle_name_bases.csv/json**: Bases for patronymic formation with fields: id, value, region, rules

**Generation rules:**

- Male patronymics: base + "ovich" or "evich"
- Female patronymics: base + "ovna" or "evna"
- Exception handling (Lev → Lvovich, Yakov → Yakovlevich, etc.)

### 4.3.3 Email Domains (Priority 1) _(High Priority)_

**Structure requirements:**

- **email_domains.csv/json**: Email domains with fields: id, value, region, weight, type

**File naming rules:**

- `email_domains_common.csv` - common domains
- `email_domains_ru.csv` - domains popular in Russia
- `email_domains_business.csv` - business domains

### 4.3.4 Phone Codes (Priority 1) _(High Priority)_

**Structure requirements:**

- **phone_codes.csv/json**: Phone codes with fields: id, value, region, type, weight
- **phone_formats.csv**: Number formats by country with fields: id, region, format, example

**File naming rules:**

- `phone_codes_ru_mobile.csv` - mobile codes for Russia
- `phone_codes_us.csv` - phone codes for USA

### 4.3.5 Synthetic Face Images (Priority 2) _(Low Priority)_

**Structure requirements:**

- **face_images.csv/json**: Information about synthetic images with fields: id, file_path, gender, age, ethnicity, region

### 4.3.6 Addresses (Priority 3) _(Low Priority)_

**Structure requirements:**

- **street_names.csv/json**: Street names
- **city_names.csv/json**: City names
- **region_names.csv/json**: Region names
- **postal_formats.csv/json**: Postal code formats

### 4.3.7 Medical Diagnoses (Priority 2) _(Low Priority)_

**Structure requirements:**

- **medical_conditions.csv/json**: Medical diagnoses with fields: id, value, code, region, category

### 4.3.8 Identification Numbers (Priority 1) _(Medium Priority)_

**Structure requirements:**

- **id_formats.csv/json**: ID formats with fields: id, region, type, format, validation_rule, example

### 4.3.9 Banking Data (Priority 1) _(Low Priority)_

**Structure requirements:**

- **bank_names.csv/json**: Bank names
- **card_bin_ranges.csv/json**: Card BIN ranges

## 4.4. Fake Data Generation Algorithms

### 4.4.1 General Principles _(High Priority)_

Generation algorithm requirements:

1. Use dictionaries as the primary source
2. Apply Faker or rule-based generation when dictionary is unavailable
3. Consider weights/frequency when selecting values
4. Maintain data consistency (gender, region)
5. Use statistical distributions for continuous data

### 4.4.2 Generation Strategy Priorities _(High Priority)_

|Priority|Strategy|Description|Application|
|---|---|---|---|
|1|Dictionary + weights|Selection from dictionary considering weights|Names, surnames, addresses|
|2|Dictionary + rules|Combination of dictionary data and rules|Patronymics, email|
|3|Faker|Use of Faker library|When dictionaries are unavailable|
|4|Rules|Purely algorithmic generation|ID numbers, phones|
|5|Placeholder|Generation of placeholders|Low-priority data|

### 4.4.3 Full Name Generation _(High Priority)_

**Algorithm requirements:**

1. Region selection and gender determination
2. First name selection from dictionary considering gender and region
3. Last name selection considering gender and region
4. For Russian names: patronymic generation based on male first name
5. Special case handling (compound names, surnames with prefixes)

### 4.4.4 Email Generation _(High Priority)_

**Algorithm requirements:**

1. Use of full name or username
2. Transformation into login using various templates:
    - {first_name}.{last_name}
    - {first_initial}.{last_name}
    - {first_name}{last_initial}
    - {first_name}{year/digits}
    - {last_name}{digits}
3. Domain selection from dictionary considering region and type
4. Combination in `username@domain` format
5. Uniqueness verification within the generated set

### 4.4.5 Phone Number Generation _(High Priority)_

**Algorithm requirements:**

1. Region and number type determination (mobile/landline)
2. Code selection from dictionary considering weights
3. Generation of remaining digits according to format
4. Number formatting according to regional standard
5. Validation using control algorithms (where applicable)

### 4.4.6 Identification Number Generation _(Medium Priority)_

**Algorithm requirements:**

1. ID type and region determination
2. Format and validation rules retrieval from dictionary
3. Generation of ID base part according to format
4. Application of specific rules (checksums)
5. Generated ID validation

### 4.4.7 Address Generation _(Low Priority)_

**Algorithm requirements:**

1. Region and address type determination
2. City selection from dictionary considering weights
3. Street selection from dictionary for the given region
4. House and apartment number generation
5. Determination of correct postal code format
6. Component combination according to regional format

### 4.4.8 Financial Data Generation _(Low Priority)_

**Requirements for credit card number generation algorithm:**

1. Card type selection (Visa, Mastercard, etc.)
2. Use of appropriate BIN (first 6 digits)
3. Random digit generation
4. Application of Luhn algorithm for checksum
5. Number formatting according to card type

## 4.5. Handling Missing Dictionaries _(Medium Priority)_

### 4.5.1 Fallback Strategy

Fallback strategy priorities when dictionary is missing:

1. Use of common dictionary
2. Substitution of dictionary from similar region
3. Use of Faker
4. Rule-based algorithmic generation
5. Use of placeholders with "FAKE_" prefix

### 4.5.2 Strategy Configuration through Configuration

Strategy configuration requirements:

- Default strategy definition for different data types
- Specification of "similar" regions for fallback strategy
- Configuration of prefixes for placeholders

### 4.5.3 Using Faker _(Medium Priority)_

Faker integration requirements:

- Mapping of regions to Faker locales
- Error handling when Faker is unavailable
- Data format consistency between Faker and custom generators

## 4.6. Ensuring Data Consistency _(High Priority)_

### 4.6.1 Consistency Principles

Core requirements:

1. Name must correspond to gender and region
2. Patronymic must correspond to gender and be related to father's name
3. Address must be consistent across country, region, and city
4. Phone code must correspond to region
5. Email must be consistent with first and last name
6. Age-related data must be consistent (birth date, work experience)

### 4.6.2 Consistency Maintenance Mechanisms

Data profile requirements:

- Centralized storage of related attributes
- Functions for generating interrelated data
- Validation of generated profile integrity

## 4.7. Integration with External Systems _(Medium Priority)_

### 4.7.1 Dictionary Loading

Loading mechanism requirements:

- Support for local files, databases, remote sources
- Unified loading interface
- Handling of various formats (CSV, JSON)
- Structure validation during loading

### 4.7.2 Dictionary Caching Mechanisms _(Medium Priority)_

Caching requirements:

- Storage of frequently used dictionaries in memory
- Cache size management
- Eviction strategies (LRU, LFU)
- Cache serialization/deserialization to disk

## 4.8. Usage Examples _(High Priority for Documentation)_

Usage example requirements:

1. Basic example of profile generation with name, email, phone
2. Example of data replacement in existing set
3. Example of complete data set generation
4. UI integration examples (if applicable)
5. End-to-end examples for typical scenarios

## 4.9. Dictionary Versioning and Updating _(Low Priority for MVP)_

### 4.9.1 Dictionary Versioning Mechanism

Versioning requirements:

- Semantic versioning of dictionaries
- Change history storage
- Compatibility control between versions

### 4.9.2 Dictionary Update Process

Dictionary update requirements:

1. Regular currency checks (quarterly)
2. Enrichment with new records
3. Weight updates based on statistical data
4. Validation and testing of updated dictionaries
5. Documentation of changes

### 4.9.3 Instructions for Expanding Dictionaries with New Languages

Documentation requirements:

- Step-by-step instructions for adding a new language
- Templates for creating dictionaries
- List of mandatory and optional dictionaries for each language
- Examples of rules for language-specific data